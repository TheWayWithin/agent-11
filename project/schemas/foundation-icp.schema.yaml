# ICP (Ideal Customer Profile) / Client Success Blueprint Schema
# Purpose: Structured user profiles for agents to understand target users
# Usage: /foundations init extracts source docs to this format

$schema: "http://json-schema.org/draft-07/schema#"
type: object
description: "Structured ideal customer profiles for user-centric development"

required:
  - primary_profile

properties:
  primary_profile:
    type: object
    required: [name, description]
    properties:
      name:
        type: string
        description: "Profile name (e.g., 'Multi-Product Indie Hacker')"
      description:
        type: string
        description: "Brief description of this user type"
      demographics:
        type: object
        properties:
          business_type:
            type: string
          team_size:
            type: string
          revenue_range:
            type: string
          products_managed:
            type: string
          years_in_business:
            type: string
          tech_savviness:
            type: string
            enum: [low, medium, high]

  personas:
    type: array
    description: "Detailed user personas"
    items:
      type: object
      required: [name, type, priority]
      properties:
        name:
          type: string
          description: "Persona name (e.g., 'Sarah the Scaling Solopreneur')"
        type:
          type: string
          description: "Persona type/category"
        priority:
          type: integer
          description: "1=primary target, 2=secondary, etc."
        demographics:
          type: object
          properties:
            products:
              type: string
            mrr:
              type: string
            support_volume:
              type: string
            stripe_accounts:
              type: integer
            email_accounts:
              type: integer
        daily_reality:
          type: string
          description: "What their day looks like"
        pain_points:
          type: array
          items:
            type: object
            properties:
              pain:
                type: string
              severity:
                type: string
                enum: [critical, high, medium, low]
              frequency:
                type: string
                enum: [daily, weekly, monthly, occasionally]
        goals:
          type: array
          items:
            type: string
        frustrations:
          type: array
          items:
            type: string
        current_solutions:
          type: array
          items:
            type: object
            properties:
              tool:
                type: string
              purpose:
                type: string
              limitation:
                type: string
        success_looks_like:
          type: string
          description: "What success means for this persona"
        quotes:
          type: array
          items:
            type: string
          description: "Representative quotes from this persona type"

  pain_points:
    type: object
    description: "Aggregated pain points across personas"
    properties:
      critical:
        type: array
        items:
          type: object
          properties:
            pain:
              type: string
            impact:
              type: string
            frequency:
              type: string
      high:
        type: array
        items:
          $ref: "#/properties/pain_points/properties/critical/items"
      medium:
        type: array
        items:
          $ref: "#/properties/pain_points/properties/critical/items"

  jobs_to_be_done:
    type: array
    description: "Jobs users are trying to accomplish"
    items:
      type: object
      properties:
        job:
          type: string
        context:
          type: string
          description: "When/why they need to do this job"
        current_approach:
          type: string
        desired_outcome:
          type: string
        success_metric:
          type: string

  buying_triggers:
    type: array
    description: "What triggers them to seek a solution"
    items:
      type: object
      properties:
        trigger:
          type: string
        timing:
          type: string
        urgency:
          type: string
          enum: [immediate, soon, eventually]

  objections:
    type: array
    description: "Common objections and how to address them"
    items:
      type: object
      properties:
        objection:
          type: string
        response:
          type: string
        evidence:
          type: string

  success_criteria:
    type: object
    description: "How customers define success"
    properties:
      quantitative:
        type: array
        items:
          type: object
          properties:
            metric:
              type: string
            target:
              type: string
            timeframe:
              type: string
      qualitative:
        type: array
        items:
          type: string

  anti_personas:
    type: array
    description: "Who we're NOT building for"
    items:
      type: object
      properties:
        type:
          type: string
        why_not:
          type: string

  # ============================================================
  # ENHANCED SECTIONS (Added for comprehensive ICP extraction)
  # ============================================================

  segment_criteria:
    type: object
    description: "Quantitative criteria for identifying ideal customers"
    properties:
      firmographics:
        type: array
        items:
          type: object
          properties:
            criterion:
              type: string
              description: "e.g., 'Annual revenue', 'Team size'"
            minimum:
              type: string
            maximum:
              type: string
            ideal:
              type: string
      technographics:
        type: array
        items:
          type: object
          properties:
            technology:
              type: string
            required:
              type: boolean
            rationale:
              type: string
      behavioral:
        type: array
        items:
          type: object
          properties:
            behavior:
              type: string
            frequency:
              type: string
            significance:
              type: string

  buying_committee:
    type: array
    description: "Decision makers and influencers in the buying process"
    items:
      type: object
      properties:
        role:
          type: string
          description: "e.g., 'Decision Maker', 'Technical Evaluator', 'Budget Holder'"
        title:
          type: string
          description: "Common job titles"
        concerns:
          type: array
          items:
            type: string
        influence_level:
          type: string
          enum: ["high", "medium", "low"]
        messaging_focus:
          type: string
          description: "What messaging resonates with this role"

  user_journey_stages:
    type: array
    description: "Customer journey from awareness to advocacy"
    items:
      type: object
      required: [stage, description]
      properties:
        stage:
          type: string
          description: "e.g., 'Awareness', 'Consideration', 'Decision', 'Onboarding', 'Retention'"
        description:
          type: string
        user_goals:
          type: array
          items:
            type: string
        touchpoints:
          type: array
          items:
            type: string
        content_needs:
          type: array
          items:
            type: string
        success_indicators:
          type: array
          items:
            type: string

  competitive_landscape:
    type: object
    description: "How target users currently solve the problem"
    properties:
      direct_competitors:
        type: array
        items:
          type: object
          properties:
            name:
              type: string
            strengths:
              type: array
              items:
                type: string
            weaknesses:
              type: array
              items:
                type: string
            user_perception:
              type: string
      indirect_alternatives:
        type: array
        items:
          type: object
          properties:
            solution:
              type: string
            why_used:
              type: string
            limitations:
              type: string
      switching_barriers:
        type: array
        items:
          type: object
          properties:
            barrier:
              type: string
            severity:
              type: string
              enum: ["high", "medium", "low"]
            mitigation:
              type: string

  validation_evidence:
    type: object
    description: "Evidence supporting ICP assumptions"
    properties:
      research_sources:
        type: array
        items:
          type: object
          properties:
            source:
              type: string
            type:
              type: string
              enum: ["interview", "survey", "analytics", "market_research", "competitor_analysis"]
            sample_size:
              type: string
            date:
              type: string
      validated_assumptions:
        type: array
        items:
          type: object
          properties:
            assumption:
              type: string
            evidence:
              type: string
            confidence:
              type: string
              enum: ["high", "medium", "low"]
      unvalidated_assumptions:
        type: array
        items:
          type: object
          properties:
            assumption:
              type: string
            validation_plan:
              type: string

  prd_cross_references:
    type: object
    description: "Links to PRD features and business rules"
    properties:
      persona_to_features:
        type: array
        items:
          type: object
          properties:
            persona:
              type: string
            primary_features:
              type: array
              items:
                type: string
              description: "Feature IDs from PRD (e.g., 'F-001')"
            must_have_for_conversion:
              type: array
              items:
                type: string
      pain_to_features:
        type: array
        items:
          type: object
          properties:
            pain_point:
              type: string
            solving_features:
              type: array
              items:
                type: string
            business_rules:
              type: array
              items:
                type: string
              description: "Business rule IDs (e.g., 'BR-001')"
